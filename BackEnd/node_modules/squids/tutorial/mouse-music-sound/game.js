/*
==========================================================
Demonstrates how to load and play music and sound effects,
and how to detect a 'mousedown' event.
Click the mouse to make a sound.
==============================================================
NOTE:
The sound and music features in Squids use the wonderful open source
Javascript library called Howler.js, which can be found 
by going to https://howlerjs.com 
==============================================================
*/

// Load an image with a call-back when finished
load_image( "squid.svg", function( image ) {
	load_sound( "sound.mp3", function( sound ) {
		load_sound( "music.mp3", function( music ) {

			// Get the width and height of the canvas
			let width = canvas.width
			let height = canvas.height

			// Create a squid
			let squid = new Squid()

			// Attach the graphic to the squid
			squid.image = image

			// Move the squid to the center of the canvas
			squid.position = vec( width * 0.5, height * 0.5 )

			// Listen for the "mousedown" event.
			squid.listen( "mousedown", function( mx, my ) {

				// Move squids to the position clicked
				squid.position = vec( mx, my );

				// Play a sound effect.
				sound.play();

			})

			// Reduce the volume of the background music
			music.volume( 0.05 );

			// Detect when the music is done and restart it.
			music.on( "end", () => {
				music.play();
			} );

			// Start the music playing
			music.play();

		}) 
	}) 
}) 

